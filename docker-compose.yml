version: "3"
services:
  nginx:
    image: nginx:latest
    container_name: production_nginx
    volumes:
     - ./nginx.conf:/etc/nginx/nginx.conf
    ports:
     - 80:80
     - 433:433

  frontend:
    container_name: frontend
    ports:
      - "3000:3000"
    build:
      context: frontend
      dockerfile: Dockerfile
    command: npm run dev
    volumes:
      - ./frontend:/usr/nextapp
      - /usr/nextapp/node_modules
      - /usr/nextapp/.next
    environment:
      MONGO_URL: "mongodb+srv://hoangduy:hoangduy123@cluster0-4ebzu.mongodb.net/PROD?retryWrites=true&w=majority"
      MONGO_URL_TEST: "mongodb+srv://hoangduy:hoangduy123@cluster0-4ebzu.mongodb.net/DEV?retryWrites=true&w=majority"
